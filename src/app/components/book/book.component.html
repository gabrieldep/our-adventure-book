<div class="book-viewport">
  <button
    type="button"
    class="fixed top-4 right-4 z-50 px-2 py-1 rounded text-xs font-typewriter bg-[#4B3621] text-[#F5F5DC] hover:bg-[#6b5344]"
    (click)="showAdmin.set(!showAdmin())"
  >
    {{ showAdmin() ? 'Hide Admin' : 'Admin' }}
  </button>
  @if (showAdmin()) {
    <app-admin />
  }

  @if (!isMobile()) {
    <aside class="fixed left-4 top-1/2 -translate-y-1/2 z-10">
      <app-timeline />
    </aside>
  }

  @if (isMobile()) {
    <h1 class="font-heading text-[#2D1B0D] text-2xl font-bold text-center mb-3">Gabriel & Ana</h1>
  }

  <div
    class="book-scaler"
    [style.width.px]="bookDesignWidth()"
    [style.height.px]="bookHeight"
    [style.transform]="'scale(' + bookScale() + ')'"
    [style.margin-bottom.px]="scaledMarginBottom()"
    (touchstart)="onTouchStart($event)"
    (touchend)="onTouchEnd($event)"
  >
    <!-- Outer leather: under-cover visible behind the pages -->
    <div class="book-outer-leather">
      @if (adventureService.isCoverPage()) {
        <div class="book-single-view">
          <div class="kraft-page kraft-page--cover flex items-center justify-center p-6">
            <app-book-cover />
          </div>
        </div>
      } @else if (isMobile()) {
        <div class="book-single-view">
          <div class="kraft-page kraft-page--single">
            <div class="page-inner kraft-inner">
              <app-adventure-page />
              <div class="page-number font-typewriter">
                {{ adventureService.currentPage()?.pageNumber }}
              </div>
            </div>
          </div>
        </div>
      } @else {
        <div class="book-spread-inner">
          <div class="kraft-page kraft-page--left">
            <div class="page-inner kraft-inner">
              <app-adventure-page />
              <div class="page-number font-typewriter">
                {{ adventureService.currentPage()?.pageNumber }}
              </div>
            </div>
          </div>
          <div class="book-crease" aria-hidden="true"></div>
          <div class="kraft-page kraft-page--right flex items-center justify-center">
            <div class="next-spread-label font-typewriter">Next spread</div>
          </div>
        </div>
      }
    </div>
  </div>

  <div class="book-nav" [class.book-nav--mobile]="isMobile()">
    <button
      type="button"
      class="book-nav-btn font-typewriter"
      [disabled]="!adventureService.hasPrevPage()"
      (click)="goPrev()"
    >
      ← Prev
    </button>
    <button
      type="button"
      class="book-nav-btn font-typewriter"
      [disabled]="!adventureService.hasNextPage()"
      (click)="goNext()"
    >
      Next →
    </button>
  </div>

  @if (isMobile()) {
    <nav class="mobile-timeline-bar">
      <app-timeline [horizontal]="true" />
    </nav>
  }
</div>
